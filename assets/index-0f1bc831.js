var kt=Object.defineProperty;var Et=(t,e,n)=>e in t?kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var g=(t,e,n)=>(Et(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function A(){}const Wt=t=>t;function Qe(t){return t()}function Be(){return Object.create(null)}function ee(t){t.forEach(Qe)}function Se(t){return typeof t=="function"}function U(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ge;function oe(t,e){return ge||(ge=document.createElement("a")),ge.href=e,t===ge.href}function Ct(t){return Object.keys(t).length===0}function et(t,...e){if(t==null)return A;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function tt(t){let e;return et(t,n=>e=n)(),e}function M(t,e,n){t.$$.on_destroy.push(et(e,n))}const nt=typeof window<"u";let It=nt?()=>window.performance.now():()=>Date.now(),Ae=nt?t=>requestAnimationFrame(t):A;const ie=new Set;function st(t){ie.forEach(e=>{e.c(t)||(ie.delete(e),e.f())}),ie.size!==0&&Ae(st)}function zt(t){let e;return ie.size===0&&Ae(st),{promise:new Promise(n=>{ie.add(e={c:t,f:n})}),abort(){ie.delete(e)}}}function y(t,e){t.appendChild(e)}function it(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function xt(t){const e=b("style");return St(it(t),e),e.sheet}function St(t,e){return y(t.head||t,e),e.sheet}function I(t,e,n){t.insertBefore(e,n||null)}function C(t){t.parentNode&&t.parentNode.removeChild(t)}function b(t){return document.createElement(t)}function me(t){return document.createTextNode(t)}function T(){return me(" ")}function ot(){return me("")}function B(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function h(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function At(t){return Array.from(t.childNodes)}function Le(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function O(t,e,n,s){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function Oe(t,e,n){t.classList[n?"add":"remove"](e)}function Ne(t,e){return new t(e)}const ye=new Map;let ke=0;function Lt(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Pt(t,e){const n={stylesheet:xt(e),rules:{}};return ye.set(t,n),n}function Tt(t,e,n,s,i,o,l,a=0){const f=16.666/s;let c=`{
`;for(let E=0;E<=1;E+=f){const z=e+(n-e)*o(E);c+=E*100+`%{${l(z,1-z)}}
`}const d=c+`100% {${l(n,1-n)}}
}`,u=`__svelte_${Lt(d)}_${a}`,p=it(t),{stylesheet:r,rules:m}=ye.get(p)||Pt(p,t);m[u]||(m[u]=!0,r.insertRule(`@keyframes ${u} ${d}`,r.cssRules.length));const w=t.style.animation||"";return t.style.animation=`${w?`${w}, `:""}${u} ${s}ms linear ${i}ms 1 both`,ke+=1,u}function Vt(t,e){const n=(t.style.animation||"").split(", "),s=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-s.length;i&&(t.style.animation=s.join(", "),ke-=i,ke||Mt())}function Mt(){Ae(()=>{ke||(ye.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&C(e)}),ye.clear())})}function Bt(t,e,n,s){if(!e)return A;const i=t.getBoundingClientRect();if(e.left===i.left&&e.right===i.right&&e.top===i.top&&e.bottom===i.bottom)return A;const{delay:o=0,duration:l=300,easing:a=Wt,start:f=It()+o,end:c=f+l,tick:d=A,css:u}=n(t,{from:e,to:i},s);let p=!0,r=!1,m;function w(){u&&(m=Tt(t,0,1,l,o,a,u)),o||(r=!0)}function E(){u&&Vt(t,m),p=!1}return zt(z=>{if(!r&&z>=f&&(r=!0),r&&z>=c&&(d(1,0),E()),!p)return!1;if(r){const W=z-f,k=0+1*a(W/l);d(k,1-k)}return!0}),w(),d(0,1),E}function Ot(t){const e=getComputedStyle(t);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:n,height:s}=e,i=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=s,Nt(t,i)}}function Nt(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const s=getComputedStyle(t),i=s.transform==="none"?"":s.transform;t.style.transform=`${i} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}let pe;function fe(t){pe=t}function Rt(){if(!pe)throw new Error("Function called outside component initialization");return pe}function rt(t){Rt().$$.on_mount.push(t)}const ue=[],he=[],be=[],Re=[],jt=Promise.resolve();let ze=!1;function Dt(){ze||(ze=!0,jt.then(lt))}function xe(t){be.push(t)}const Ie=new Set;let _e=0;function lt(){const t=pe;do{for(;_e<ue.length;){const e=ue[_e];_e++,fe(e),Ft(e.$$)}for(fe(null),ue.length=0,_e=0;he.length;)he.pop()();for(let e=0;e<be.length;e+=1){const n=be[e];Ie.has(n)||(Ie.add(n),n())}be.length=0}while(ue.length);for(;Re.length;)Re.pop()();ze=!1,Ie.clear(),fe(t)}function Ft(t){if(t.fragment!==null){t.update(),ee(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(xe)}}const ve=new Set;let G;function ct(){G={r:0,c:[],p:G}}function at(){G.r||ee(G.c),G=G.p}function q(t,e){t&&t.i&&(ve.delete(t),t.i(e))}function X(t,e,n,s){if(t&&t.o){if(ve.has(t))return;ve.add(t),G.c.push(()=>{ve.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function qt(t,e){t.d(1),e.delete(t.key)}function Ut(t,e){X(t,1,1,()=>{e.delete(t.key)})}function Xt(t,e){t.f(),qt(t,e)}function ut(t,e,n,s,i,o,l,a,f,c,d,u){let p=t.length,r=o.length,m=p;const w={};for(;m--;)w[t[m].key]=m;const E=[],z=new Map,W=new Map;for(m=r;m--;){const x=u(i,o,m),L=n(x);let _=l.get(L);_?s&&_.p(x,e):(_=c(L,x),_.c()),z.set(L,E[m]=_),L in w&&W.set(L,Math.abs(m-w[L]))}const k=new Set,V=new Set;function Z(x){q(x,1),x.m(a,d),l.set(x.key,x),d=x.first,r--}for(;p&&r;){const x=E[r-1],L=t[p-1],_=x.key,S=L.key;x===L?(d=x.first,p--,r--):z.has(S)?!l.has(_)||k.has(_)?Z(x):V.has(S)?p--:W.get(_)>W.get(S)?(V.add(_),Z(x)):(k.add(S),p--):(f(L,l),p--)}for(;p--;){const x=t[p];z.has(x.key)||f(x,l)}for(;r;)Z(E[r-1]);return E}function re(t){t&&t.c()}function J(t,e,n,s){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),s||xe(()=>{const l=t.$$.on_mount.map(Qe).filter(Se);t.$$.on_destroy?t.$$.on_destroy.push(...l):ee(l),t.$$.on_mount=[]}),o.forEach(xe)}function Q(t,e){const n=t.$$;n.fragment!==null&&(ee(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Yt(t,e){t.$$.dirty[0]===-1&&(ue.push(t),Dt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Y(t,e,n,s,i,o,l,a=[-1]){const f=pe;fe(t);const c=t.$$={fragment:null,ctx:[],props:o,update:A,not_equal:i,bound:Be(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:Be(),dirty:a,skip_bound:!1,root:e.target||f.$$.root};l&&l(c.root);let d=!1;if(c.ctx=n?n(t,e.props||{},(u,p,...r)=>{const m=r.length?r[0]:p;return c.ctx&&i(c.ctx[u],c.ctx[u]=m)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](m),d&&Yt(t,u)),p}):[],c.update(),d=!0,ee(c.before_update),c.fragment=s?s(c.ctx):!1,e.target){if(e.hydrate){const u=At(e.target);c.fragment&&c.fragment.l(u),u.forEach(C)}else c.fragment&&c.fragment.c();e.intro&&q(t.$$.fragment),J(t,e.target,e.anchor,e.customElement),lt()}fe(f)}class H{$destroy(){Q(this,1),this.$destroy=A}$on(e,n){if(!Se(n))return A;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!Ct(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ne=[];function ft(t,e=A){let n;const s=new Set;function i(a){if(U(t,a)&&(t=a,n)){const f=!ne.length;for(const c of s)c[1](),ne.push(c,t);if(f){for(let c=0;c<ne.length;c+=2)ne[c][0](ne[c+1]);ne.length=0}}}function o(a){i(a(t))}function l(a,f=A){const c=[a,f];return s.add(c),s.size===1&&(n=e(i)||A),a(t),()=>{s.delete(c),s.size===0&&(n(),n=null)}}return{set:i,update:o,subscribe:l}}function Ht(){return{close:!0,minimize:!0,maximize:!1}}function N(t=void 0){let e=ft(t),n={cachedValue:void 0,set(s){n.cachedValue=s,e.set(s)},subscribe:e.subscribe,update(s){let i=s(n.cachedValue);n.cachedValue=i,e.set(i)},get:()=>n.cachedValue};return n}class Zt{constructor(e,n,s,i){g(this,"stores");this.stores=new Kt(e,n,s,i)}get x(){return this.stores.x.get()}set x(e){this.stores.x.set(e)}get y(){return this.stores.y.get()}set y(e){this.stores.y.set(e)}get zIndex(){return this.stores.zIndex.get()}set zIndex(e){this.stores.zIndex.set(e)}get width(){return this.stores.width.get()}set width(e){this.stores.width.set(e)}get height(){return this.stores.height.get()}set height(e){this.stores.height.set(e)}get title(){return this.stores.title.get()}set title(e){this.stores.title.set(e)}get classes(){return this.stores.classes.get()}set classes(e){this.stores.classes.set(e)}get style(){return this.stores.style.get()}set style(e){this.stores.style.set(e)}get resizable(){return this.stores.resizable.get()}set resizable(e){this.stores.resizable.set(e)}get important(){return this.stores.important.get()}set important(e){this.stores.important.set(e)}get isVisible(){return this.stores.isVisible.get()}set isVisible(e){this.stores.isVisible.set(e)}get icon(){return this.stores.icon.get()}set icon(e){this.stores.icon.set(e)}get controlButtons(){return this.stores.controlButtons.get()}set controlButtons(e){this.stores.controlButtons.set(e)}}class Kt{constructor(e,n,s,i){g(this,"classes",N(""));g(this,"style",N(""));g(this,"title",N());g(this,"icon",N());g(this,"resizable",N(!1));g(this,"important",N(!1));g(this,"isVisible",N(!0));g(this,"controlButtons",N(Ht()));g(this,"height");g(this,"width");g(this,"x");g(this,"y");g(this,"zIndex",N(0));this.x=N(e),this.y=N(n),this.width=N(s),this.height=N(i)}}class ae{constructor(e,n=void 0){g(this,"window");g(this,"listeners",[]);g(this,"listen",e=>(this.listeners.push(e),()=>{this.listeners=this.listeners.filter(n=>n!=e)}));g(this,"trigger",(e=void 0)=>{this.listeners.forEach(n=>{n(this.window,e??this.defaultOptions)})});this.defaultOptions=n,this.window=e}}const D=class extends Zt{constructor(n,s,i,o,l){super(n,s,i,o);g(this,"_process");g(this,"windowElement");g(this,"onPopInEnd",n=>{let s=this.windowElement,i=o=>{o.animationName=="pop-in"&&(s.removeEventListener("animationend",i),n(),s.style.animationDirection="normal")};this.windowElement.addEventListener("animationend",i)});g(this,"playCloseAnimation",()=>{this.windowElement.classList.remove("window-spawn"),this.windowElement.style.animationDirection="reverse",this.windowElement.offsetWidth,this.windowElement.classList.add("window-spawn")});g(this,"kill",()=>{this.closeEvent.trigger();let n=D.windows.filter(s=>s!=this);D.windowsStore.set(n),this.process.getWindows().length==0&&this.process.kill()});g(this,"dragStart",new ae(this));g(this,"dragStop",new ae(this));g(this,"onFocus",new ae(this));g(this,"onUnfocus",new ae(this));g(this,"closeEvent",new ae(this));this.component=l}static get activeWindow(){return this.activeWindowStore.get()}static set activeWindow(n){var s,i;n!=this.activeWindow&&((i=(s=this.activeWindow)==null?void 0:s.onUnfocus)==null||i.trigger()),n!=null&&(n.process.lastActiveWindow=n,n.onFocus.trigger()),this.activeWindowStore.set(n)}static getWindows(){return[...this.windows]}get process(){return this._process}get isAlive(){return this._process!=null}get isActive(){return D.activeWindow==this}get isVisible(){return tt(this.stores.isVisible)}set isVisible(n){n==!1?(this.playCloseAnimation(),this.onPopInEnd(()=>{this.stores.isVisible.set(!1),D.activeWindow==this&&(D.activeWindow=void 0)})):this.stores.isVisible.set(!0)}hide(){this.isVisible=!1}unhide(){this.isVisible=!0}close(){this.playCloseAnimation(),this.onPopInEnd(this.kill)}};let P=D;g(P,"windowsStore",N([])),g(P,"windows"),g(P,"activeWindowStore",N(void 0)),g(P,"spawn",(n,s)=>(D.windowsStore.set([...D.windows,n]),n._process=s,n.title==null&&(n.title=n.process.app.name),n)),(()=>{D.windowsStore.subscribe(n=>{D.windows=n})})();let dt=0;const de=()=>dt++,je=()=>dt;function De(t){let e;return{c(){e=b("div"),O(e,"height",t[2]+"px"),O(e,"width",t[5]+"px"),h(e,"class","absolute")},m(n,s){I(n,e,s)},p(n,s){s&4&&O(e,"height",n[2]+"px"),s&32&&O(e,"width",n[5]+"px")},d(n){n&&C(e)}}}function $t(t){let e,n,s,i,o,l=t[1]&&De(t);var a=t[0].component;function f(c){return{props:{window:c[0],process:c[0].process}}}return a&&(s=Ne(a,f(t))),{c(){e=b("div"),l&&l.c(),n=T(),s&&re(s.$$.fragment),h(e,"style",i="height: "+t[2]+"px;"+t[3]),h(e,"class",t[4])},m(c,d){I(c,e,d),l&&l.m(e,null),y(e,n),s&&J(s,e,null),o=!0},p(c,[d]){c[1]?l?l.p(c,d):(l=De(c),l.c(),l.m(e,n)):l&&(l.d(1),l=null);const u={};if(d&1&&(u.window=c[0]),d&1&&(u.process=c[0].process),a!==(a=c[0].component)){if(s){ct();const p=s;X(p.$$.fragment,1,0,()=>{Q(p,1)}),at()}a?(s=Ne(a,f(c)),re(s.$$.fragment),q(s.$$.fragment,1),J(s,e,null)):s=null}else a&&s.$set(u);(!o||d&12&&i!==(i="height: "+c[2]+"px;"+c[3]))&&h(e,"style",i),(!o||d&16)&&h(e,"class",c[4])},i(c){o||(s&&q(s.$$.fragment,c),o=!0)},o(c){s&&X(s.$$.fragment,c),o=!1},d(c){c&&C(e),l&&l.d(),s&&Q(s)}}}function Gt(t,e,n){let s,i,o,l,{window:a}=e,{notImportant:f}=e,{style:c,classes:d,height:u,width:p}=a.stores;return M(t,c,r=>n(3,i=r)),M(t,d,r=>n(4,o=r)),M(t,u,r=>n(2,s=r)),M(t,p,r=>n(5,l=r)),t.$$set=r=>{"window"in r&&n(0,a=r.window),"notImportant"in r&&n(1,f=r.notImportant)},[a,f,s,i,o,l,c,d,u,p]}class Jt extends H{constructor(e){super(),Y(this,e,Gt,$t,U,{window:0,notImportant:1})}}function Fe(t){let e,n,s;return{c(){e=b("img"),oe(e.src,n=t[8])||h(e,"src",n),h(e,"alt",s=t[9]+" icon"),h(e,"height",18),h(e,"width",18),h(e,"class","ml-1.5")},m(i,o){I(i,e,o)},p(i,o){o[0]&256&&!oe(e.src,n=i[8])&&h(e,"src",n),o[0]&512&&s!==(s=i[9]+" icon")&&h(e,"alt",s)},d(i){i&&C(e)}}}function Qt(t){let e,n;return{c(){e=b("span"),n=me(t[9]),h(e,"class","pl-2 text-gray-400")},m(s,i){I(s,e,i),y(e,n)},p(s,i){i[0]&512&&Le(n,s[9])},d(s){s&&C(e)}}}function en(t){let e,n;return{c(){e=b("span"),n=me(t[9]),h(e,"class","pl-2")},m(s,i){I(s,e,i),y(e,n)},p(s,i){i[0]&512&&Le(n,s[9])},d(s){s&&C(e)}}}function qe(t){let e,n,s;return{c(){e=b("span"),e.textContent="_",h(e,"class","pr-1.5")},m(i,o){I(i,e,o),n||(s=B(e,"click",t[25]),n=!0)},p:A,d(i){i&&C(e),n=!1,s()}}}function Ue(t){let e;return{c(){e=b("span"),e.textContent="□",h(e,"class","pr-1.5")},m(n,s){I(n,e,s)},d(n){n&&C(e)}}}function tn(t){let e;return{c(){e=b("span"),e.textContent="x",h(e,"class","text-gray-500")},m(n,s){I(n,e,s)},p:A,d(n){n&&C(e)}}}function nn(t){let e,n,s;return{c(){e=b("span"),e.textContent="x"},m(i,o){I(i,e,o),n||(s=B(e,"click",t[26]),n=!0)},p:A,d(i){i&&C(e),n=!1,s()}}}function sn(t){let e,n,s,i,o,l,a,f,c,d,u,p,r,m,w=t[8]!==void 0&&t[8].length!==0&&Fe(t);function E(_,S){return _[10]===_[0]?en:Qt}let z=E(t),W=z(t),k=t[11].minimize&&qe(t),V=t[11].maximize&&Ue();function Z(_,S){return _[11].close?nn:tn}let x=Z(t),L=x(t);return u=new Jt({props:{window:t[0],notImportant:t[2]}}),{c(){e=b("div"),n=b("div"),s=b("div"),w&&w.c(),i=T(),W.c(),o=T(),l=b("div"),a=b("span"),k&&k.c(),f=T(),V&&V.c(),c=T(),L.c(),d=T(),re(u.$$.fragment),h(s,"class","flex items-center"),h(a,"class","pr-2.5 mb-1"),h(l,"class","flex items-center"),h(n,"class","h-7 flex justify-between title-bar text-sm rounded-t-md rounded-sm select-none svelte-jpt6my"),O(n,"width",t[4]-2+"px"),h(e,"class","absolute border rounded-t-md rounded-sm border-gray-800 drop-shadow-md window-spawn"),O(e,"width",t[4]+"px"),O(e,"left",t[5]+"px"),O(e,"top",t[6]+"px"),O(e,"z-index",t[7]),Oe(e,"hidden",!t[3])},m(_,S){I(_,e,S),y(e,n),y(n,s),w&&w.m(s,null),y(s,i),W.m(s,null),y(n,o),y(n,l),y(l,a),k&&k.m(a,null),y(a,f),V&&V.m(a,null),y(a,c),L.m(a,null),t[27](n),y(e,d),J(u,e,null),t[28](e),p=!0,r||(m=[B(n,"mousedown",t[22]),B(n,"mouseup",t[23]),B(n,"mousemove",t[24]),B(e,"mousedown",t[29])],r=!0)},p(_,S){_[8]!==void 0&&_[8].length!==0?w?w.p(_,S):(w=Fe(_),w.c(),w.m(s,i)):w&&(w.d(1),w=null),z===(z=E(_))&&W?W.p(_,S):(W.d(1),W=z(_),W&&(W.c(),W.m(s,null))),_[11].minimize?k?k.p(_,S):(k=qe(_),k.c(),k.m(a,f)):k&&(k.d(1),k=null),_[11].maximize?V||(V=Ue(),V.c(),V.m(a,c)):V&&(V.d(1),V=null),x===(x=Z(_))&&L?L.p(_,S):(L.d(1),L=x(_),L&&(L.c(),L.m(a,null))),(!p||S[0]&16)&&O(n,"width",_[4]-2+"px");const te={};S[0]&1&&(te.window=_[0]),S[0]&4&&(te.notImportant=_[2]),u.$set(te),(!p||S[0]&16)&&O(e,"width",_[4]+"px"),(!p||S[0]&32)&&O(e,"left",_[5]+"px"),(!p||S[0]&64)&&O(e,"top",_[6]+"px"),(!p||S[0]&128)&&O(e,"z-index",_[7]),(!p||S[0]&8)&&Oe(e,"hidden",!_[3])},i(_){p||(q(u.$$.fragment,_),p=!0)},o(_){X(u.$$.fragment,_),p=!1},d(_){_&&C(e),w&&w.d(),W.d(),k&&k.d(),V&&V.d(),L.d(),t[27](null),Q(u),t[28](null),r=!1,ee(m)}}}function Xe(t){let e=0,n=0;if(t instanceof MouseEvent)e=t.pageX,n=t.pageY;else if(t instanceof TouchEvent){const s=t.touches[0];e=s.pageX,n=s.pageY}return[e,n]}function on(t,e,n){let s,i,o,l,a,f,c,d,u,p,{window:r}=e,{classes:m,title:w,icon:E,x:z,y:W,width:k,height:V,style:Z,controlButtons:x,isVisible:L,zIndex:_}=r.stores;M(t,w,v=>n(9,d=v)),M(t,E,v=>n(8,c=v)),M(t,z,v=>n(5,l=v)),M(t,W,v=>n(6,a=v)),M(t,k,v=>n(4,o=v)),M(t,x,v=>n(11,p=v)),M(t,L,v=>n(3,i=v)),M(t,_,v=>n(7,f=v));let S,te,Pe,We=!1;rt(()=>{n(0,r.zIndex=de(),r)});function Te(){s||(P.activeWindow=r,r.zIndex<=je()&&n(0,r.zIndex=de(),r))}let{activeWindowStore:Ve}=P;M(t,Ve,v=>n(10,u=v));function wt(v){if(s||v instanceof MouseEvent&&v.button!==0)return;let[j,Ce]=Xe(v);const we=document.body,Me=S.getBoundingClientRect();te=j-(Me.left+we.scrollLeft-we.clientLeft),Pe=Ce-(Me.top+we.scrollTop-we.clientTop),We=!0,r.zIndex<=je()&&n(0,r.zIndex=de(),r),v instanceof MouseEvent&&v.preventDefault(),document.addEventListener("mousemove",K=>{ce(K)}),document.addEventListener("mouseup",K=>{le(K)}),document.addEventListener("touchmove",K=>{ce(K)},{passive:!1}),document.addEventListener("touchend",K=>{le(K)},{passive:!1}),r.dragStart.trigger()}function le(v){v instanceof MouseEvent&&v.button!==0||(We=!1,v instanceof MouseEvent&&v.preventDefault(),document.removeEventListener("mousemove",j=>{ce(j)}),document.removeEventListener("mouseup",j=>{le(j)}),document.removeEventListener("touchmove",j=>{ce(j)}),document.removeEventListener("touchend",j=>{le(j)}),r.dragStop.trigger())}function ce(v){if(s||!We)return;let[j,Ce]=Xe(v);n(0,r.x=j-(te??0),r),n(0,r.y=Ce-(Pe??0),r),v.preventDefault()}const gt=()=>r.hide(),_t=()=>r.close();function bt(v){he[v?"unshift":"push"](()=>{S=v,n(1,S)})}function vt(v){he[v?"unshift":"push"](()=>{r.windowElement=v,n(0,r)})}const yt=()=>Te();return t.$$set=v=>{"window"in v&&n(0,r=v.window)},t.$$.update=()=>{t.$$.dirty[0]&1&&n(2,s=r.process.getImportantWindows().length!=0&&!r.important)},[r,S,s,i,o,l,a,f,c,d,u,p,w,E,z,W,k,x,L,_,Te,Ve,wt,le,ce,gt,_t,bt,vt,yt]}class rn extends H{constructor(e){super(),Y(this,e,on,sn,U,{window:0},null,[-1,-1])}}function Ye(t,e,n){const s=t.slice();return s[3]=e[n],s}function He(t,e){let n,s,i;return s=new rn({props:{window:e[3]}}),{key:t,first:null,c(){n=ot(),re(s.$$.fragment),this.first=n},m(o,l){I(o,n,l),J(s,o,l),i=!0},p(o,l){e=o;const a={};l&1&&(a.window=e[3]),s.$set(a)},i(o){i||(q(s.$$.fragment,o),i=!0)},o(o){X(s.$$.fragment,o),i=!1},d(o){o&&C(n),Q(s,o)}}}function ln(t){let e=[],n=new Map,s,i,o=t[0];const l=a=>a[3];for(let a=0;a<o.length;a+=1){let f=Ye(t,o,a),c=l(f);n.set(c,e[a]=He(c,f))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();s=ot()},m(a,f){for(let c=0;c<e.length;c+=1)e[c].m(a,f);I(a,s,f),i=!0},p(a,[f]){f&1&&(o=a[0],ct(),e=ut(e,f,l,1,a,o,n,s.parentNode,Ut,He,s,Ye),at())},i(a){if(!i){for(let f=0;f<o.length;f+=1)q(e[f]);i=!0}},o(a){for(let f=0;f<e.length;f+=1)X(e[f]);i=!1},d(a){for(let f=0;f<e.length;f+=1)e[f].d(a);a&&C(s)}}}function cn(t,e,n){let s,i,o=P.windowsStore;return M(t,o,l=>n(2,i=l)),t.$$.update=()=>{t.$$.dirty&4&&n(0,s=i)},[s,o,i]}class an extends H{constructor(e){super(),Y(this,e,cn,ln,U,{})}}const pt="/assets/mastrielIcon-6c62ac08.svg",se=class{constructor(e,n,s=pt){this.name=e,this.mainWindow=n,this.icon=s}};let R=se;g(R,"registeredApps",[]),g(R,"registerApp",e=>{se.registeredApps.push(e)}),g(R,"getApp",e=>se.registeredApps.find(n=>n.name==e)),g(R,"getAllApps",()=>[...se.registeredApps]),g(R,"getAppByType",e=>{let n=se.registeredApps.find(s=>s instanceof e);if(n==null)throw new Error("Invalid app specified. Is it registered?");return n});let Ze=0;function un(){return Ze++,Ze-1}function Ke(t){let e,n,s;return{c(){e=b("button"),e.textContent="Continue"},m(i,o){I(i,e,o),n||(s=B(e,"mousedown",t[3]),n=!0)},p:A,d(i){i&&C(e),n=!1,s()}}}function fn(t){let e,n,s,i,o=t[0].message+"",l,a,f,c,d,u,p,r=!t[0].unrecoverable&&Ke(t);return{c(){e=b("div"),n=b("div"),s=b("div"),i=b("span"),l=me(o),a=T(),f=b("div"),r&&r.c(),c=T(),d=b("button"),d.textContent="End Process",h(i,"class","text-center error-message whitespace-pre-line select-text svelte-wbgunv"),h(i,"style",""),h(s,"class","flex justify-center"),h(n,"class","h-20 error-message overflow-y-scroll scrollbar-hide svelte-wbgunv"),O(n,"width",t[1]+"px"),h(e,"class","bg-red-800 border-b border-b-red-700 pt-3 drop-shadow-xl"),h(f,"class","flex justify-around pt-5")},m(m,w){I(m,e,w),y(e,n),y(n,s),y(s,i),y(i,l),I(m,a,w),I(m,f,w),r&&r.m(f,null),y(f,c),y(f,d),u||(p=B(d,"mousedown",t[4]),u=!0)},p(m,[w]){w&1&&o!==(o=m[0].message+"")&&Le(l,o),w&2&&O(n,"width",m[1]+"px"),m[0].unrecoverable?r&&(r.d(1),r=null):r?r.p(m,w):(r=Ke(m),r.c(),r.m(f,c))},i:A,o:A,d(m){m&&C(e),m&&C(a),m&&C(f),r&&r.d(),u=!1,p()}}}function dn(t,e,n){let s,{process:i}=e,{window:o}=e,{width:l}=o.stores;M(t,l,c=>n(1,s=c)),o.classes="bg-red-900",o.title=o.errorTitle,o.important=!0,o.controlButtons={maximize:!1,minimize:!1,close:!1},P.activeWindow=o,o.closeEvent.listen(()=>{P.activeWindow=o.spawner});const a=()=>{o.close(),P.activeWindow=i.mainWindow},f=()=>{i.kill()};return t.$$set=c=>{"process"in c&&n(5,i=c.process),"window"in c&&n(0,o=c.window)},[o,s,l,a,f,i]}class pn extends H{constructor(e){super(),Y(this,e,dn,fn,U,{process:5,window:0})}}class $e extends P{constructor(e,n,s,i=!1){super(500,500,400,160,pn),this.errorTitle=e,this.message=n,this.spawner=s,this.unrecoverable=i}}const $=class{constructor(e,n,s){g(this,"id");g(this,"app");g(this,"mainWindow");g(this,"lastActiveWindow");g(this,"options");g(this,"spawnWindow",e=>P.spawn(e,this));g(this,"kill",()=>{for(const e of this.getWindows())e.close();$.processesStore.update(e=>e.filter(n=>n!=this))});g(this,"crash",(e,n)=>{this.spawnWindow(new $e("Fatal Error",`${this.app.name} has crashed:
${e}`,n,!0))});g(this,"error",(e,n)=>{this.spawnWindow(new $e("Error",`An error has occurred in ${this.app.name}:
${e}


hi`,n,!1))});this.id=n,this.app=e,s!=null&&(this.options=s)}getWindows(){return P.getWindows().filter(e=>e.process==this)??[]}getImportantWindows(){return this.getWindows().filter(e=>e.important)??[]}static mergeOptions(e,n){return{...n,...e}}};let F=$;g(F,"processesStore",ft([])),g(F,"getProcesses",()=>tt($.processesStore)),g(F,"spawn",(e,n)=>{let s=R.getAppByType(e),i=$.mergeOptions(n,e.defaultOptions),o=new $(s,un(),i);$.processesStore.update(a=>[...a,o]);let l=new P(300,300,400,400,s.mainWindow);return o.mainWindow=P.spawn(l,o),o.lastActiveWindow=o.mainWindow,o});function hn(t){const e=t-1;return e*e*e+1}function mn(t,{from:e,to:n},s={}){const i=getComputedStyle(t),o=i.transform==="none"?"":i.transform,[l,a]=i.transformOrigin.split(" ").map(parseFloat),f=e.left+e.width*l/n.width-(n.left+l),c=e.top+e.height*a/n.height-(n.top+a),{delay:d=0,duration:u=r=>Math.sqrt(r)*120,easing:p=hn}=s;return{delay:d,duration:Se(u)?u(Math.sqrt(f*f+c*c)):u,easing:p,css:(r,m)=>{const w=m*f,E=m*c,z=r+m*e.width/n.width,W=r+m*e.height/n.height;return`transform: ${o} translate(${w}px, ${E}px) scale(${z}, ${W});`}}}function Ge(t,e,n){const s=t.slice();return s[11]=e[n],s}function wn(t){let e;return{c(){e=b("span"),e.textContent=".",h(e,"class","text-center block")},m(n,s){I(n,e,s)},d(n){n&&C(e)}}}function gn(t){let e;return{c(){e=b("span"),e.textContent="_",h(e,"class","text-center block")},m(n,s){I(n,e,s)},d(n){n&&C(e)}}}function Je(t,e){let n,s,i,o,l,a,f,c,d,u=A,p,r;function m(W,k){return k&3&&(a=null),a==null&&(a=!!W[0](W[11])),a?gn:wn}let w=m(e,-1),E=w(e);function z(){return e[6](e[11])}return{key:t,first:null,c(){n=b("div"),s=b("img"),l=T(),E.c(),f=T(),oe(s.src,i=e[11].app.icon)||h(s,"src",i),h(s,"width","30"),h(s,"height","30"),h(s,"alt",o=`${e[11].app.name}`),h(s,"class","translate-y-2.5"),h(n,"class",c=(e[0](e[11])?"selected":"unselected")+" process svelte-1h8nwke"),this.first=n},m(W,k){I(W,n,k),y(n,s),y(n,l),E.m(n,null),y(n,f),p||(r=B(n,"click",z),p=!0)},p(W,k){e=W,k&2&&!oe(s.src,i=e[11].app.icon)&&h(s,"src",i),k&2&&o!==(o=`${e[11].app.name}`)&&h(s,"alt",o),w!==(w=m(e,k))&&(E.d(1),E=w(e),E&&(E.c(),E.m(n,f))),k&3&&c!==(c=(e[0](e[11])?"selected":"unselected")+" process svelte-1h8nwke")&&h(n,"class",c)},r(){d=n.getBoundingClientRect()},f(){Ot(n),u()},a(){u(),u=Bt(n,d,mn,{duration:200})},d(W){W&&C(n),E.d(),p=!1,r()}}}function _n(t){let e,n,s,i,o,l,a=[],f=new Map,c=t[1];const d=u=>u[11];for(let u=0;u<c.length;u+=1){let p=Ge(t,c,u),r=d(p);f.set(r,a[u]=Je(r,p))}return{c(){e=b("div"),e.innerHTML='<div class="h-12 w-screen z-0 bg-taskbar svelte-1h8nwke"></div>',n=T(),s=b("div"),s.innerHTML='<div class="h-12 w-screen max-z-index bg-taskbar-blur svelte-1h8nwke"></div>',i=T(),o=b("div"),l=b("div");for(let u=0;u<a.length;u+=1)a[u].c();h(e,"class","fixed bottom-0 z-0"),h(s,"class","fixed bottom-0 max-z-index svelte-1h8nwke"),h(l,"class","h-12 w-screen max-z-index taskbar-contents flex items-center justify-center gap-1 svelte-1h8nwke"),h(o,"class","fixed bottom-0 max-z-index svelte-1h8nwke")},m(u,p){I(u,e,p),I(u,n,p),I(u,s,p),I(u,i,p),I(u,o,p),y(o,l);for(let r=0;r<a.length;r+=1)a[r].m(l,null)},p(u,[p]){if(p&19){c=u[1];for(let r=0;r<a.length;r+=1)a[r].r();a=ut(a,p,d,1,u,c,f,l,Xt,Je,null,Ge);for(let r=0;r<a.length;r+=1)a[r].a()}},i:A,o:A,d(u){u&&C(e),u&&C(n),u&&C(s),u&&C(i),u&&C(o);for(let p=0;p<a.length;p+=1)a[p].d()}}}function bn(t,e,n){let s,i,o,l=F.processesStore;M(t,l,r=>n(1,o=r));let a=P.activeWindowStore;M(t,a,r=>n(5,i=r));const f=r=>{s(r)?d(r):(c(r),u(r))},c=r=>{console.log(r),r.getWindows().forEach(m=>{m.unhide(),m.zIndex=de()})},d=r=>{r.getWindows().forEach(m=>{m.hide(),P.activeWindow=void 0})},u=r=>{P.activeWindow=r.lastActiveWindow,console.log("Focus!"),r.getWindows().sort(m=>m.zIndex).forEach(m=>{console.log("Window!"),m.zIndex=de()})},p=r=>f(r);return t.$$.update=()=>{t.$$.dirty&32&&n(0,s=r=>(i==null?void 0:i.process)===r)},[s,o,l,a,f,i,p]}class vn extends H{constructor(e){super(),Y(this,e,bn,_n,U,{})}}function yn(t){let e,n,s,i,o,l,a,f,c;return l=new an({}),f=new vn({}),{c(){e=b("div"),n=b("img"),i=T(),o=b("div"),re(l.$$.fragment),a=T(),re(f.$$.fragment),oe(n.src,s=pt)||h(n,"src",s),h(n,"alt","Site icon"),h(n,"height",256),h(n,"width",256),h(n,"class","drop-shadow-3xl"),h(e,"class","flex items-center justify-center h-screen w-screen absolute"),h(o,"class","absolute")},m(d,u){I(d,e,u),y(e,n),I(d,i,u),I(d,o,u),J(l,o,null),I(d,a,u),J(f,d,u),c=!0},p:A,i(d){c||(q(l.$$.fragment,d),q(f.$$.fragment,d),c=!0)},o(d){X(l.$$.fragment,d),X(f.$$.fragment,d),c=!1},d(d){d&&C(e),d&&C(i),d&&C(o),Q(l),d&&C(a),Q(f,d)}}}class kn extends H{constructor(e){super(),Y(this,e,null,yn,U,{})}}function En(t){return t[Math.floor(Math.random()*t.length)]}const ht="/assets/consoleIcon-9d1dc8de.svg",Wn=t=>new Promise(e=>setTimeout(e,t)),Cn="/assets/chatroomIcon-cd53aa5d.svg";function In(t){let e,n,s;return{c(){e=b("iframe"),h(e,"class",n="w-full h-full "+(t[2]==t[0]?"pointer-events-auto":"pointer-events-none")),oe(e.src,s="https://chatroom-d29ab.web.app/")||h(e,"src",s)},m(i,o){I(i,e,o),t[5](e)},p(i,[o]){o&5&&n!==(n="w-full h-full "+(i[2]==i[0]?"pointer-events-auto":"pointer-events-none"))&&h(e,"class",n)},i:A,o:A,d(i){i&&C(e),t[5](null)}}}function zn(t,e,n){let s,{process:i}=e,{window:o}=e;o.icon=i.app.icon,o.width=600,o.height=600;let l;const a=()=>{l!=null&&n(1,l.style.pointerEvents="none",l)},f=()=>{l!=null&&n(1,l.style.pointerEvents="",l)};o.dragStart.listen(()=>{a()}),o.dragStop.listen(()=>{f()});let c=P.activeWindowStore;M(t,c,u=>n(2,s=u));function d(u){he[u?"unshift":"push"](()=>{l=u,n(1,l)})}return t.$$set=u=>{"process"in u&&n(4,i=u.process),"window"in u&&n(0,o=u.window)},[o,l,s,c,i,d]}class xn extends H{constructor(e){super(),Y(this,e,zn,In,U,{process:4,window:0})}}class mt extends R{constructor(){super("Chatroom",xn,Cn)}}function Sn(t){let e,n,s,i,o,l,a,f,c,d,u,p,r,m,w,E,z,W;return{c(){e=b("div"),n=b("span"),n.textContent="Remove process",s=T(),i=b("span"),i.textContent="Update color",o=T(),l=b("span"),l.textContent="Update title",a=T(),f=b("span"),f.textContent="Spawn another",c=T(),d=b("span"),d.textContent="Show error",u=T(),p=b("span"),p.textContent="Show unrecoverable error",r=T(),m=b("span"),m.textContent="Turn invisible temporarily",w=T(),E=b("span"),E.textContent="Open Chatroom",h(n,"class","link svelte-18apmpb"),h(i,"class","link svelte-18apmpb"),h(l,"class","link svelte-18apmpb"),h(f,"class","link svelte-18apmpb"),h(d,"class","link svelte-18apmpb"),h(p,"class","link svelte-18apmpb"),h(m,"class","link svelte-18apmpb"),h(E,"class","link svelte-18apmpb"),h(e,"class","pt-2 pl-3 options svelte-18apmpb")},m(k,V){I(k,e,V),y(e,n),y(e,s),y(e,i),y(e,o),y(e,l),y(e,a),y(e,f),y(e,c),y(e,d),y(e,u),y(e,p),y(e,r),y(e,m),y(e,w),y(e,E),z||(W=[B(n,"click",t[0]),B(i,"click",t[2]),B(l,"click",t[3]),B(f,"click",t[1]),B(d,"click",t[4]),B(p,"click",t[5]),B(m,"click",t[6]),B(E,"click",t[7])],z=!0)},p:A,i:A,o:A,d(k){k&&C(e),z=!1,ee(W)}}}function An(t,e,n){let{process:s}=e,{window:i}=e,o=s.options;i.icon=ht,i.style="background-color: "+o.backgroundColor;let l;rt(()=>{l=0});function a(){s.kill(),console.log("Process killed!")}const f=()=>{let w=F.spawn(Ee);console.log("New process spawned!"),console.log(w),P.activeWindow=w.mainWindow},c=()=>{let w=["bg-red","bg-blue","bg-lime","bg-black"];n(8,i.classes=En(w),i),console.log("Color updated!")},d=()=>{l+=1,n(8,i.title=l.toString(),i),console.log("Title updated!")},u=()=>{s.error("User has initiated an error.",i)},p=()=>{s.crash("User has forced a crash.",i)},r=async()=>{n(8,i.isVisible=!1,i),await Wn(3e3),n(8,i.isVisible=!0,i)},m=async()=>{let w=F.spawn(mt);P.activeWindow=w.mainWindow};return t.$$set=w=>{"process"in w&&n(9,s=w.process),"window"in w&&n(8,i=w.window)},[a,f,c,d,u,p,r,m,i,s]}class Ln extends H{constructor(e){super(),Y(this,e,An,Sn,U,{process:9,window:8})}}class Ee extends R{constructor(){super("Console",Ln,ht)}}g(Ee,"defaultOptions",{backgroundColor:"#000000"});new kn({target:document.getElementById("app")});R.registerApp(new Ee);R.registerApp(new mt);F.spawn(Ee,{backgroundColor:"#1a1d1e"});
